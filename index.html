<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>一年级一班同学学习卡</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #e0f7fa 0%, #f3e5f5 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .header {
            text-align: center;
            padding: 20px 0;
            background-color: #7e57c2;
            color: white;
            border-radius: 15px 15px 0 0;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(126, 87, 194, 0.3);
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 15px;
        }
        
        .instruction {
            background-color: #ffecb3;
            color: #5d4037;
            padding: 15px;
            border-radius: 10px;
            margin: 20px auto;
            max-width: 600px;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .instructions p {
            margin: 10px 0;
            font-size: 1.1rem;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            padding: 12px 25px;
            background-color: #5c6bc0;
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .control-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 12px rgba(0, 0, 0, 0.3);
        }
        
        .sound-toggle {
            background-color: #4caf50;
            /* No special positioning needed, flex handles it */
        }
        
        .sound-toggle.muted {
            background-color: #f44336;
        }
        
        .sound-toggle::before {
            content: '';
            /* Sizing for the flex item (icon) */
            flex-shrink: 0;
            width: 24px;
            height: 24px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }
        
        .sound-toggle:not(.muted)::before {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>');
        }
        
        .sound-toggle.muted::before {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M3.63 3.63a.996.996 0 0 0 0 1.41L7.29 9H3v6h4l5 5v-6.59l4.18 4.18c-.65.49-1.38.88-2.18 1.11v2.06c1.34-.3 2.57-.92 3.61-1.75l2.04 2.04 1.41-1.41L5.05 3.63c-.39-.39-1.02-.39-1.42 0zM19 12c0 .94-.2 1.82-.54 2.64l1.51 1.51A8.96 8.96 0 0 0 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zm-7-8l-4.59 4.59L9 7.83V3h2v1z"/></svg>');
        }
        
        .student-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 25px;
            max-width: 1300px;
            margin: 0 auto;
        }
        
        .gender-section {
            flex: 1;
            min-width: 300px;
            max-width: 600px;
        }
        
        .gender-title {
            text-align: center;
            margin-bottom: 25px;
            padding: 12px;
            border-radius: 10px;
            color: white;
            font-size: 1.5rem;
        }
        
        .boys .gender-title {
            background-color: #29b6f6;
        }
        
        .girls .gender-title {
            background-color: #ec407a;
        }
        
        .student-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
            gap: 18px;
        }
        
        .student-card {
            background-color: white;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .student-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }
        
        .student-card.boy:hover {
            background-color: #e1f5fe;
            border: 2px solid #81d4fa;
        }
        
        .student-card.girl:hover {
            background-color: #fce4ec;
            border: 2px solid #f8bbd0;
        }
        
        .student-name {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .student-pinyin {
            color: #78909c;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }
        
        .student-gender {
            font-size: 1rem;
            padding: 3px 10px;
            border-radius: 15px;
            display: inline-block;
        }
        
        .student-card.boy .student-gender {
            background-color: #e1f5fe;
            color: #0288d1;
        }
        
        .student-card.girl .student-gender {
            background-color: #fce4ec;
            color: #d81b60;
        }
        
        .speaker-icon {
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 1.3rem;
            opacity: 0.3;
        }
        
        .active {
            animation: pulse 0.5s;
            border: 2px solid #ffc107;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #757575;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .student-container {
                flex-direction: column;
                align-items: center;
            }
            
            .gender-section {
                width: 100%;
            }
            
            .control-btn {
                padding: 10px 20px;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>一年级一班同学学习卡</h1>
        <p>点击卡片听同学名字的发音</p>
    </div>
    
    <div class="instruction">
        小朋友，点击下面的名字卡片，可以听到同学的姓名发音哦！
    </div>
    
    <div class="controls">
        <button id="playAllBoys" class="control-btn">顺序朗读男同学</button>
        <button id="playAllGirls" class="control-btn">顺序朗读女同学</button>
        <button id="toggleMute" class="control-btn sound-toggle">声音开启</button>
    </div>
    
    <div class="student-container">
        <!-- 男生部分 -->
        <div class="gender-section boys">
            <div class="gender-title">男同学</div>
            <div class="student-list" id="boysList">
                <!-- 男生名单由JavaScript动态生成 -->
            </div>
        </div>
        
        <!-- 女生部分 -->
        <div class="gender-section girls">
            <div class="gender-title">女同学</div>
            <div class="student-list" id="girlsList">
                <!-- 女生名单由JavaScript动态生成 -->
            </div>
        </div>
    </div>
    
    <div class="footer">
        提示：请确保设备音量已打开 | 适用于Chrome、Edge、Firefox等现代浏览器
    </div>

    <script>
        // 班级学生数据
        const classmates = [
            // 男生
            { name: "常宇", gender: "男", pinyin: "Cháng Yǔ" },
            { name: "陈子玉", gender: "男", pinyin: "Chén Zǐyù" },
            { name: "杜泽溪", gender: "男", pinyin: "Dù Zéxī" },
            { name: "耿言蹊", gender: "男", pinyin: "Gěng Yánxī" },
            { name: "姬楷烨", gender: "男", pinyin: "Jī Kǎiyè" },
            { name: "李俊煦", gender: "男", pinyin: "Lǐ Jùnxù" },
            { name: "李易恒", gender: "男", pinyin: "Lǐ Yìhéng" },
            { name: "李梓晨", gender: "男", pinyin: "Lǐ Zǐchén" },
            { name: "刘浩轩", gender: "男", pinyin: "Liú Hàoxuān" },
            { name: "刘芷霖", gender: "男", pinyin: "Liú Zhǐlín" },
            { name: "马若宸", gender: "男", pinyin: "Mǎ Ruòchén" },
            { name: "彭一鸣", gender: "男", pinyin: "Péng Yīmíng" },
            { name: "孙宜恩", gender: "男", pinyin: "Sūn Yí’ēn" },
            { name: "王程煊", gender: "男", pinyin: "Wáng Chéngxuān" },
            { name: "王汘寻", gender: "男", pinyin: "Wáng Qiānxún" },
            { name: "王子臻", gender: "男", pinyin: "Wáng Zǐzhēn" },
            { name: "吴昊宇", gender: "男", pinyin: "Wú Hàoyǔ" },
            { name: "徐健宁", gender: "男", pinyin: "Xú Jiànníng" },
            { name: "闫颢森", gender: "男", pinyin: "Yán Hàosēn" },
            { name: "杨毅博", gender: "男", pinyin: "Yáng Yìbó" },
            { name: "张贺铭", gender: "男", pinyin: "Zhāng Hèmíng" },
            { name: "张舒粲", gender: "男", pinyin: "Zhāng Shūcàn" },
            { name: "张逸睢", gender: "男", pinyin: "Zhāng Yìsuī" },
            { name: "赵梓睿", gender: "男", pinyin: "Zhào Zǐruì" },
            { name: "周昱林", gender: "男", pinyin: "Zhōu Yùlín" },
            
            // 女生
            { name: "戴梓嫣", gender: "女", pinyin: "Dài Zǐyān" },
            { name: "房家睿", gender: "女", pinyin: "Fáng Jiāruì" },
            { name: "房家宜", gender: "女", pinyin: "Fáng Jiāyí" },
            { name: "葛依然", gender: "女", pinyin: "Gě Yīrán" },
            { name: "何婧怡", gender: "女", pinyin: "Hé Jìngyí" },
            { name: "孔柠阳", gender: "女", pinyin: "Kǒng Níngyáng" },
            { name: "李园慈", gender: "女", pinyin: "Lǐ Yuáncí" },
            { name: "刘洛伊", gender: "女", pinyin: "Liú Luòyī" },
            { name: "刘熙媛", gender: "女", pinyin: "Liú Xīyuán" },
            { name: "马墨涵", gender: "女", pinyin: "Mǎ Mòhán" },
            { name: "牛姚馨", gender: "女", pinyin: "Niú Yáoxīn" },
            { name: "任嘉宝", gender: "女", pinyin: "Rèn Jiābǎo" },
            { name: "宋一彤", gender: "女", pinyin: "Sòng Yītóng" },
            { name: "王晨语", gender: "女", pinyin: "Wáng Chényǔ" },
            { name: "王诗雨", gender: "女", pinyin: "Wáng Shīyǔ" },
            { name: "肖艺橦", gender: "女", pinyin: "Xiāo Yìtóng" },
            { name: "闫佳淇", gender: "女", pinyin: "Yán Jiāqí" },
            { name: "游梓希", gender: "女", pinyin: "Yóu Zǐxī" },
            { name: "张惜颜", gender: "女", pinyin: "Zhāng Xīyán" },
            { name: "赵珂妍", gender: "女", pinyin: "Zhào Kēyán" },
            { name: "郑皓月", gender: "女", pinyin: "Zhèng Hàoyuè" },
            { name: "刘桉绮", gender: "女", pinyin: "Liú Ānqǐ" }
        ];

        // DOM元素
        const boysList = document.getElementById('boysList');
        const girlsList = document.getElementById('girlsList');
        const playAllBoys = document.getElementById('playAllBoys');
        const playAllGirls = document.getElementById('playAllGirls');
        const toggleMute = document.getElementById('toggleMute');
        
        // 全局状态
        let isMuted = false;
        let isPlaying = false;
        let audioUnlocked = false; // 用于跟踪音频是否被用户手势激活

        // 检查浏览器是否支持语音合成
        function supportsSpeechSynthesis() {
            return 'speechSynthesis' in window;
        }

        // “解锁”音频的函数
        function unlockAudio() {
            if (audioUnlocked) return;
            // 尝试播放一个无声的语音来激活
            const utterance = new SpeechSynthesisUtterance('');
            window.speechSynthesis.speak(utterance);
            audioUnlocked = true;
        }

        // 朗读名字的函数
        function speakName(name, element = null, onEndCallback = null) {
            if (!supportsSpeechSynthesis()) return;

            // 视觉反馈
            if (element) {
                element.classList.add('active');
                setTimeout(() => element.classList.remove('active'), 500);
            }

            if (isMuted) {
                if (onEndCallback) onEndCallback();
                return;
            }
            
            // 在汉字之间添加空格以提高发音清晰度
            const spacedName = name.split('').join(' ');

            const utterance = new SpeechSynthesisUtterance(spacedName);
            utterance.lang = 'zh-CN';
            utterance.rate = 0.8; // 降低语速
            
            utterance.onend = () => {
                if (onEndCallback) {
                    setTimeout(onEndCallback, 300); // 名字之间增加一点延迟
                }
            };

            // 在播放前清除之前的队列，防止重叠
            window.speechSynthesis.cancel(); 
            window.speechSynthesis.speak(utterance);
        }

        // 顺序朗读函数
        function playAll(gender) {
            if (isPlaying) return; // 如果正在播放，则不允许再次点击
            
            unlockAudio(); // 每次开始朗读前都尝试解锁

            isPlaying = true;
            const list = gender === '男' ? boysList : girlsList;
            const cards = list.querySelectorAll('.student-card');
            let currentIndex = 0;

            function next() {
                if (currentIndex < cards.length && isPlaying) {
                    const card = cards[currentIndex];
                    const name = card.querySelector('.student-name').textContent;
                    speakName(name, card, () => {
                        currentIndex++;
                        next();
                    });
                } else {
                    isPlaying = false; // 队列播放完成
                }
            }

            next();
        }

        // 停止所有朗读
        function stopAllPlayback() {
            isPlaying = false;
            window.speechSynthesis.cancel();
        }

        // 初始化页面
        function initPage() {
            // 创建学生卡片
            classmates.forEach(student => {
                const card = document.createElement('div');
                card.className = `student-card ${student.gender === '男' ? 'boy' : 'girl'}`;
                card.innerHTML = `
                    <span class="speaker-icon">🔊</span>
                    <div class="student-name">${student.name}</div>
                    <div class="student-pinyin">${student.pinyin}</div>
                    <div class="student-gender">${student.gender}</div>
                `;
                
                card.addEventListener('click', () => {
                    unlockAudio(); // 每次点击都尝试激活音频
                    stopAllPlayback(); // 如果正在顺序朗读，则停止
                    speakName(student.name, card);
                });
                
                if (student.gender === '男') {
                    boysList.appendChild(card);
                } else {
                    girlsList.appendChild(card);
                }
            });
            
            playAllBoys.addEventListener('click', () => playAll('男'));
            playAllGirls.addEventListener('click', () => playAll('女'));
            
            toggleMute.addEventListener('click', () => {
                isMuted = !isMuted;
                
                if (isMuted) {
                    toggleMute.textContent = '声音关闭';
                    toggleMute.classList.add('muted');
                    stopAllPlayback(); // 静音时停止所有播放
                } else {
                    toggleMute.textContent = '声音开启';
                    toggleMute.classList.remove('muted');
                }
            });
            
            if (!supportsSpeechSynthesis()) {
                alert('提示：您的浏览器不支持语音朗读功能。请使用 Chrome、Edge 或 Safari 打开此页面。');
                toggleMute.disabled = true;
                toggleMute.textContent = '不支持语音';
                toggleMute.classList.add('muted');
            }

            // 增加一个全局点击事件来首次激活音频
            document.body.addEventListener('click', unlockAudio, { once: true });
        }

        window.addEventListener('DOMContentLoaded', initPage);
    </script>
</body>
</html>

